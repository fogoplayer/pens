<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Tiling</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Architects+Daughter&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="flex">
    <section></section>
    <form >
      <h1 class="colspan">Reference Tiler</h1>
      <label for="file">
        Image
      </label>
      <input type="file" name="image" id="file" />

      <hr class="colspan">

      <h2 class="colspan">Final Dimensions</h2>
      <div class="colspan flex flex-center">
        <label class="flex-even" for="width">Width</label>
        <input class="flex-even ratioed" id="width" name="width" type="number" step="any">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path d="M11 44q-1.25 0-2.125-.875T8 41V19.3q0-1.25.875-2.125T11 16.3h3.5v-4.8q0-3.95 2.775-6.725Q20.05 2 24 2q3.95 0 6.725 2.775Q33.5 7.55 33.5 11.5v4.8H37q1.25 0 2.125.875T40 19.3V41q0 1.25-.875 2.125T37 44Zm0-3h26V19.3H11V41Zm13-7q1.6 0 2.725-1.1t1.125-2.65q0-1.5-1.125-2.725T24 26.3q-1.6 0-2.725 1.225T20.15 30.25q0 1.55 1.125 2.65Q22.4 34 24 34Zm-6.5-17.7h13v-4.8q0-2.7-1.9-4.6Q26.7 5 24 5q-2.7 0-4.6 1.9-1.9 1.9-1.9 4.6ZM11 41V19.3 41Z"/></svg>
        <label class="flex-even" for="height">Height</label>
        <input class="flex-even ratioed" id="height" name="height" type="number" step="any">
      </div>
      <div class="flex colspan flex-center">
        <label>
          <input type="radio" name="units" id="units-inches" value="inches" checked />
          inches
        </label>
        <label>
          <input type="radio" name="units" id="units-centimeters" value="centimeters" />
          centimeters
        </label>
      </div>
      
      <hr class="colspan"> 
      
      <h2 class="colspan">Paper</h2>
      <label for="paper-size">Paper Size</label>
      <select name="paperSize" id="paper-size">
        <option value="letter">Letter</option>
        <option value="a4">A4</option>
      </select>

      Orientation
      <div class="flex">
        <label>
          <input type="radio" name="orientation" id="orientation-portrait" value="portrait" checked />
          Portrait
        </label>
        <label>
          <input type="radio" name="orientation" id="orientation-landscape" value="landscape" />
          Landscape
        </label>
      </div>

      <hr class="colspan">

      <h2 class="colspan">Margins</h2>
      <label for="overlap">
        Minimum Overlap
      </label>
      <div class="flex">
        <input
          type="range"
          id="overlap"
          class="responsive"
        />
        <input
          for="overlap"
          id="overlap-output"
          class="responsive"
          name="overlap"
          type="number"
          contenteditable
        ></input>
      </div>

      <label for="margin">
        Margins
      </label>
      <div class="flex">
        <input
          type="range"
          id="margin"
          class="responsive"
        />
        <input
          for="margin"
          id="margin-output"
          class="responsive"
          name="margin"
          type="number"
          contenteditable
        ></input>
      </div>
      <button class="colspan">Save</button>
    </form>
  </body>
</html>
<script>
  const aspectRatio = 1.5; // width / height
  const PAPER_SIZES = { // storing in pixels so that it's measurement-system-agnostic
    letter: {width: 816, height: 1056},
    a4: {width:792, height:1128}
  }
  const INCH = 96 // px
  const CENTIMETER = 37.8 // px

  const form = document.querySelector("form")
  form.onsubmit = (e)=> {
    e.preventDefault()
    const formData = new FormData(form);
    for (const [key, value] of formData) {
      formData[key] = value;
    }
    
    const {image, width, height, units, paperSize, orientation, overlap, margin} = formData
    
    debugger
  }

  // Link dimensions
  document.querySelectorAll(".ratioed").forEach((el) => {
    el.oninput = function rangeUpdate(e) {
      const {value, id, parentNode} = e.target
      if (id === "width") {
        parentNode.querySelector("#height").value = value / aspectRatio
      }else{
        parentNode.querySelector("#width").value = value * aspectRatio
      }
    };
  });

  // Link ranges to outputs
  document.querySelectorAll(".responsive").forEach((el) => {
    el.value=0.5;
    el.max=4;         el.min=0;
         el.step=0.001;
    el.oninput = function rangeUpdate(e) {
      const value = e.target.value;
      const parent = e.target.parentNode;
      parent.querySelector("[type='range']").value = value;
      parent.querySelector("[type='number']").value = value;
    };
  });
</script>
<style>
  * {
    box-sizing: border-box;
    font-family: inherit;
  }

  body {
    max-height: 100vh;
    margin: 0;
    padding: 0;
    overflow: hidden;
    width: 100vw;
    height: 100vh;

    font-family: "Architects Daughter", cursive;
  }

  section {
    flex: 1 1 auto;
  }

  svg {
    fill: currentColor;
    width: 1.5em;
    height: 1.5em;
  }

  form {
    flex: 0 0 25em;

    display: grid;
    column-gap: 0.5em;
    row-gap: 1em;
    grid-template-columns: auto 1fr;
    grid-auto-rows: max-content;

    background-color: lightblue;
    background-color: darkblue;
    color:white;
    padding: 2em;
  }

  .colspan {
    grid-column: 1 / 3;
    margin: 0;
    padding: 0;
    text-align: center;
  }

  .flex{
    display: flex;
    flex-flow: row nowrap;
    gap: 0.5em
  }

  .flex-center {
    justify-content: center
  }

  form input[type="range"] {
    flex: 1 1 auto
  }
  form input[type="number"] {
    flex: 0 0 4em;
    width: 4em;
  }
</style>
